$(document).ready(function(){$("#chart_name").text("Patient assessment of Compliance rates in categories");var t=20,a={top:50,bottom:50,left:120,right:120},e=$("body").width()-a.left-a.right,n=700-a.top-a.bottom,r=d3.select("div#svg").append("svg").attr("width",e+a.left+a.right).attr("height",700);d3.tsv("data/localDENovartis_Apps_Compliance-20_Categories_Pat.txt",function(o,i){var l=d3.max(i,function(t){return Number(t["fair compliance"])})+d3.max(i,function(t){return Number(t["over compliance"])})+d3.max(i,function(t){return Number(t["low compliance"])});l=1e3*Math.ceil(l/1e3);var c=d3.scale.linear().domain([0,l]).rangeRound([0,e]),s=d3.scale.linear().domain([0,l]).rangeRound([0,e]),p=d3.svg.axis().scale(s).orient("bottom").ticks(5).outerTickSize(0),d=d3.scale.ordinal().domain(i.map(function(t){return t["Market Segments"].toLowerCase()})).rangeRoundBands([0,n]),u=d3.svg.axis().scale(d).orient("left");r.append("g").attr("class","axis").attr("transform","translate("+a.left+","+(n+a.top)+")").transition().duration(500).call(p).selectAll("text").attr("y",20),r.append("g").attr("class","axis yaxis").attr("transform","translate("+a.left+","+a.top+")").transition().duration(500).call(u);var f=r.selectAll("body").data(i).enter().append("g");f.attr("class","backgroundAxis").append("line").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("y1",function(e,r){return.5*(n/i.length-t)+r*(t+(n/i.length-t))+a.top}).attr("x1",a.left).attr("y2",function(e,r){return.5*(n/i.length-t)+r*(t+(n/i.length-t))+a.top}).attr("x2",e+a.left);var m=r.selectAll("body").data(i).enter().append("g").attr("class","item");m.append("rect").attr("class","low_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 50*a}).attr("x",function(t,e){return a.left}).attr("y",function(t,e){return n/i.length*e+a.top}).attr("height",n/i.length-t).attr("width",function(t,a){return c(t["low compliance"])}),m.append("rect").attr("class","fair_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 250+50*a}).attr("x",function(t,e){return a.left+c(t["low compliance"])}).attr("y",function(t,e){return n/i.length*e+a.top}).attr("height",n/i.length-t).attr("width",function(t,a){return c(t["fair compliance"])}),m.append("rect").attr("class","over_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 500+50*a}).attr("x",function(t,e){return a.left+c(t["low compliance"])+c(t["fair compliance"])}).attr("y",function(t,e){return n/i.length*e+a.top}).attr("height",n/i.length-t).attr("width",function(t,a){return c(t["over compliance"])});var g=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);m.on("mouseover",function(t){var a="<table><tbody><tr><td><span class='color low_compliance'></span><span>low compliance</span></td><td class='value'>"+t["low compliance"]+"</td></tr><tr><td><span class='color fair_compliance'></span><span>fair compliance</span></td><td class='value'>"+t["fair compliance"]+"</td></tr><tr><td><span class='color over_compliance'></span><span>over compliance</span></td><td class='value'>"+t["over compliance"]+"</td></tr></tbody></table>";g.html(a).style("left",d3.event.pageX+20+"px").style("top",d3.event.pageY+"px").style("opacity",1)}).on("mousemove",function(t){g.style("left",d3.event.pageX+20+"px").style("top",d3.event.pageY+"px")}).on("mouseout",function(t){g.style("opacity",0)})}),$.ajax({url:"data/localDENovartis_Apps_Compliance-20_Categories_Pat.txt",success:function(t){for(var a="",e=t.split("\n"),n=0;n<e.length;n++){var r=e[n].split("	");if(0==n){for(var o=0;o<r.length;o++)a=a+"<th>"+r[o]+"</th>";$("table thead").append("<tr>"+a+"</tr>")}else{for(var o=0;o<r.length;o++)a=a+"<td>"+r[o]+"</td>";$("table tbody").append("<tr>"+a+"</tr>")}a=""}}})});