$(document).ready(function(){var t=1e3,a=580,e=20,n=80,r=80,o=d3.select("div#svg").append("svg").attr("width",t).attr("height",a);d3.tsv("data/localDENovartis_Apps_Compliance-20_Categories_Percent.txt",function(i,c){var l=1,s=d3.scale.linear().domain([0,l]).rangeRound([0,t-r]),p=d3.scale.linear().domain([0,l]).rangeRound([0,t-r]),d=d3.scale.ordinal().domain(c.map(function(t){return t["Market Segments"].toLowerCase()})).rangePoints([0,a-n-e],1),u=d3.svg.axis().scale(d).orient("left");o.append("g").attr("class","axis yaxis").attr("transform","translate("+r+","+n+")").transition().duration(500).call(u);var f=o.selectAll("body").data(c).enter().append("g").attr("class","item");f.append("rect").attr("class","low_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 50*a}).attr("x",function(t,a){return r}).attr("y",function(t,r){return(a-e-n)/c.length*r+n}).attr("height",a/c.length-e).attr("width",function(t,a){return s(t["low compliance"])}),f.append("rect").attr("class","fair_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 250+50*a}).attr("x",function(t,a){return r+s(t["low compliance"])}).attr("y",function(t,r){return(a-e-n)/c.length*r+n}).attr("height",a/c.length-e).attr("width",function(t,a){return s(t["fair compliance"])}),f.append("rect").attr("class","over_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 500+50*a}).attr("x",function(t,a){return r+s(t["low compliance"])+s(t["fair compliance"])}).attr("y",function(t,r){return(a-e-n)/c.length*r+n}).attr("height",a/c.length-e).attr("width",function(t,a){return s(t["over compliance"])}).append("animate").attr("attributeName","width").attr("begin","0.5").attr("from","0").attr("to",function(t,a){return s(t["over compliance"])}).attr("dur","0.25");var m=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);f.on("mouseover",function(t){var a="<table><tbody><tr><td><span class='color low_compliance'></span><span>low compliance</span></td><td class='value'>"+t["low compliance"]+"</td></tr><tr><td><span class='color fair_compliance'></span><span>fair compliance</span></td><td class='value'>"+t["fair compliance"]+"</td></tr><tr><td><span class='color over_compliance'></span><span>over compliance</span></td><td class='value'>"+t["over compliance"]+"</td></tr></tbody></table>";m.html(a).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+20+"px").style("opacity",1)}).on("mousemove",function(t){m.style("left",d3.event.pageX+"px").style("top",d3.event.pageY+20+"px")}).on("mouseout",function(t){m.style("opacity",0)});var g=["low compliance","fair compliance","over compliance"],h=o.selectAll("body").data(g).enter().append("g").attr("class","label");h.append("rect").attr("class","label").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("x",function(a,e){return t-135*(g.length-e)}).attr("y",n/2-13).attr("width",14).attr("height",14).attr("class",function(t){return t.replace(" ","_")}),h.append("text").attr("class","label_text").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("x",function(a,e){return t-135*(g.length-e)+20}).attr("y",n/2).text(function(t){return t})}),$.ajax({url:"data/localDENovartis_Apps_Compliance-20_Categories_Percent.txt",success:function(t){for(var a="",e=t.split("\n"),n=0;n<e.length;n++){var r=e[n].split("	");if(0==n){for(var o=0;o<r.length;o++)a=a+"<th>"+r[o]+"</th>";$("table thead").append("<tr>"+a+"</tr>")}else{for(var o=0;o<r.length;o++)a=a+"<td>"+r[o]+"</td>";$("table tbody").append("<tr>"+a+"</tr>")}a=""}}})});