$(document).ready(function(){var t=1e3,a=580,n=20,e=80,r=80,o=d3.select("div#svg").append("svg").attr("width",t).attr("height",a);d3.tsv("data/localDENovartis_Apps_Compliance-20_Categories_Pat.txt",function(i,l){var c=d3.max(l,function(t){return Number(t["fair compliance"])})>d3.max(l,function(t){return Number(t["over compliance"])})?d3.max(l,function(t){return Number(t["fair compliance"])}):d3.max(l,function(t){return Number(t["over compliance"])});console.log(c);var s=d3.scale.linear().domain([0,c]).rangeRound([0,(t-r)/2]),p=d3.scale.linear().domain([0,c]).rangeRound([0,(t-r)/2]),d=d3.svg.axis().scale(p).orient("bottom").ticks(5),u=d3.scale.linear().domain([0,c]).rangeRound([(t-r)/2,0]),m=d3.svg.axis().scale(u).orient("bottom").ticks(5),f=d3.scale.ordinal().domain(l.map(function(t){return t["Market Segments"].toLowerCase()})).rangePoints([0,a-e-n],1),g=d3.svg.axis().scale(f).orient("left");o.append("g").attr("class","axis").attr("transform","translate("+((t-r)/2+r)+","+(a-n)+")").transition().duration(500).call(d),o.append("g").attr("class","axis").attr("transform","translate("+r+","+(a-n)+")").transition().duration(500).call(m),o.append("g").attr("class","axis yaxis").attr("transform","translate("+r+","+e+")").transition().duration(500).call(g);var v=o.selectAll("body").data(l).enter().append("g");v.attr("class","backgroundAxis").append("line").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("y1",function(t,r){return(a-e-n)/l.length*(r+1)+e/2+5}).attr("x1",r).attr("y2",function(t,r){return(a-e-n)/l.length*(r+1)+e/2+5}).attr("x2",t);var h=o.selectAll("body").data(l).enter().append("g").attr("class","item");h.append("rect").attr("class","fair_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 50*a}).attr("x",(t-r)/2+r).attr("y",function(t,r){return(a-n-e)/l.length*r+e}).attr("height",a/l.length-n).attr("width",function(t,a){return s(t["fair compliance"])}),h.append("rect").attr("class","over_compliance").attr("width",0).transition().duration(250).ease("swing").delay(function(t,a){return 50*a}).attr("x",(t-r)/2+r).attr("y",function(t,r){return(a-n-e)/l.length*r+e}).attr("height",a/l.length-n).attr("width",function(t,a){return s(t["over compliance"])}),h.append("rect").attr("class","low_compliance").attr("width",0).attr("x",function(a,n){return(t-r)/2+r}).attr("y",function(t,r){return(a-n-e)/l.length*r+e}).transition().duration(250).ease("swing").delay(function(t,a){return 50*a}).attr("x",function(a,n){return(t-r)/2+r-s(a["low compliance"])}).attr("y",function(t,r){return(a-n-e)/l.length*r+e}).attr("height",a/l.length-n).attr("width",function(t,a){return s(t["low compliance"])});var y=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);h.on("mouseover",function(t){var a="<table><tbody><tr><td><span class='color low_compliance'></span><span>low compliance</span></td><td class='value'>"+t["low compliance"]+"</td></tr><tr><td><span class='color fair_compliance'></span><span>fair compliance</span></td><td class='value'>"+t["fair compliance"]+"</td></tr><tr><td><span class='color over_compliance'></span><span>over compliance</span></td><td class='value'>"+t["over compliance"]+"</td></tr></tbody></table>";y.html(a).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+20+"px").style("opacity",1)}).on("mousemove",function(t){y.style("left",d3.event.pageX+"px").style("top",d3.event.pageY+20+"px")}).on("mouseout",function(t){y.style("opacity",0)});var x=["low compliance","fair compliance","over compliance"],b=o.selectAll("body").data(x).enter().append("g").attr("class","label");b.append("rect").attr("class","label").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("x",function(a,n){return t-135*(x.length-n)}).attr("y",e/2-13).attr("width",14).attr("height",14).attr("class",function(t){return t.replace(" ","_")}),b.append("text").attr("class","label_text").attr("opacity",0).transition().duration(500).attr("opacity",1).attr("x",function(a,n){return t-135*(x.length-n)+20}).attr("y",e/2).text(function(t){return t})}),$.ajax({url:"data/localDENovartis_Apps_Compliance-20_Categories_Pat.txt",success:function(t){for(var a="",n=t.split("\n"),e=0;e<n.length;e++){var r=n[e].split("	");if(0==e){for(var o=0;o<r.length;o++)a=a+"<th>"+r[o]+"</th>";$("table thead").append("<tr>"+a+"</tr>")}else{for(var o=0;o<r.length;o++)a=a+"<td>"+r[o]+"</td>";$("table tbody").append("<tr>"+a+"</tr>")}a=""}}})});